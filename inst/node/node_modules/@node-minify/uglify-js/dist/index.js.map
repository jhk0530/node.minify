{"version":3,"sources":["../src/index.ts"],"sourcesContent":["/*!\n * node-minify\n * Copyright(c) 2011-2023 Rodolphe Stoclin\n * MIT Licensed\n */\n\n/**\n * Module dependencies.\n */\nimport uglifyJS from 'uglify-js';\nimport { utils } from '@node-minify/utils';\nimport { MinifierOptions, Options, Settings } from '@node-minify/types';\n\ninterface OptionsUglifyJS extends Omit<Options, 'sourceMap'> {\n  sourceMap?: { filename: string };\n}\n\ninterface SettingsUglifyJS extends Omit<Settings, 'options'> {\n  options: OptionsUglifyJS;\n}\n\ninterface MinifierOptionsUglifyJS extends Omit<MinifierOptions, 'settings'> {\n  settings: SettingsUglifyJS;\n}\n\n/**\n * Run uglifyJS.\n *\n * @param {Object} settings\n * @param {String} content\n * @param {Function} callback\n */\nconst minifyUglifyJS = ({ settings, content, callback, index }: MinifierOptionsUglifyJS) => {\n  const contentMinified = uglifyJS.minify(typeof content === 'string' ? content : '', settings && settings.options);\n  if (contentMinified.error) {\n    if (callback) {\n      return callback(contentMinified.error);\n    }\n  }\n  if (contentMinified.map && settings && typeof settings.options.sourceMap === 'object') {\n    // TODO\n    utils.writeFile({ file: settings.options.sourceMap.filename, content: contentMinified.map, index });\n  }\n  if (settings && !settings.content && settings.output) {\n    utils.writeFile({ file: settings.output, content: contentMinified.code, index });\n  }\n  if (callback) {\n    return callback(null, contentMinified.code);\n  }\n  return contentMinified.code;\n};\n\n/**\n * Expose `minifyUglifyJS()`.\n */\nminifyUglifyJS.default = minifyUglifyJS;\nexport = minifyUglifyJS;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AASA,uBAAqB;AACrB,mBAAsB;AAsBtB,IAAM,iBAAiB,CAAC,EAAE,UAAU,SAAS,UAAU,MAAM,MAA+B;AAC1F,QAAM,kBAAkB,iBAAAA,QAAS,OAAO,OAAO,YAAY,WAAW,UAAU,IAAI,YAAY,SAAS,OAAO;AAChH,MAAI,gBAAgB,OAAO;AACzB,QAAI,UAAU;AACZ,aAAO,SAAS,gBAAgB,KAAK;AAAA,IACvC;AAAA,EACF;AACA,MAAI,gBAAgB,OAAO,YAAY,OAAO,SAAS,QAAQ,cAAc,UAAU;AAErF,uBAAM,UAAU,EAAE,MAAM,SAAS,QAAQ,UAAU,UAAU,SAAS,gBAAgB,KAAK,MAAM,CAAC;AAAA,EACpG;AACA,MAAI,YAAY,CAAC,SAAS,WAAW,SAAS,QAAQ;AACpD,uBAAM,UAAU,EAAE,MAAM,SAAS,QAAQ,SAAS,gBAAgB,MAAM,MAAM,CAAC;AAAA,EACjF;AACA,MAAI,UAAU;AACZ,WAAO,SAAS,MAAM,gBAAgB,IAAI;AAAA,EAC5C;AACA,SAAO,gBAAgB;AACzB;AAKA,eAAe,UAAU;AACzB,iBAAS;","names":["uglifyJS"]}