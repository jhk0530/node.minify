{"version":3,"sources":["../src/index.ts"],"sourcesContent":["/*!\n * node-minify\n * Copyright(c) 2011-2023 Rodolphe Stoclin\n * MIT Licensed\n */\n\n/**\n * Module dependencies.\n */\nimport uglifyJS from 'uglify-js';\nimport { utils } from '@node-minify/utils';\nimport { MinifierOptions, Options, Settings } from '@node-minify/types';\n\ninterface OptionsUglifyJS extends Omit<Options, 'sourceMap'> {\n  sourceMap?: { filename: string };\n}\n\ninterface SettingsUglifyJS extends Omit<Settings, 'options'> {\n  options: OptionsUglifyJS;\n}\n\ninterface MinifierOptionsUglifyJS extends Omit<MinifierOptions, 'settings'> {\n  settings: SettingsUglifyJS;\n}\n\n/**\n * Run uglifyJS.\n *\n * @param {Object} settings\n * @param {String} content\n * @param {Function} callback\n */\nconst minifyUglifyJS = ({ settings, content, callback, index }: MinifierOptionsUglifyJS) => {\n  const contentMinified = uglifyJS.minify(typeof content === 'string' ? content : '', settings && settings.options);\n  if (contentMinified.error) {\n    if (callback) {\n      return callback(contentMinified.error);\n    }\n  }\n  if (contentMinified.map && settings && typeof settings.options.sourceMap === 'object') {\n    // TODO\n    utils.writeFile({ file: settings.options.sourceMap.filename, content: contentMinified.map, index });\n  }\n  if (settings && !settings.content && settings.output) {\n    utils.writeFile({ file: settings.output, content: contentMinified.code, index });\n  }\n  if (callback) {\n    return callback(null, contentMinified.code);\n  }\n  return contentMinified.code;\n};\n\n/**\n * Expose `minifyUglifyJS()`.\n */\nminifyUglifyJS.default = minifyUglifyJS;\nexport = minifyUglifyJS;\n"],"mappings":";;;;;;AASA,OAAO,cAAc;AACrB,SAAS,aAAa;AAVtB;AAAA;AAgCA,QAAM,iBAAiB,CAAC,EAAE,UAAU,SAAS,UAAU,MAAM,MAA+B;AAC1F,YAAM,kBAAkB,SAAS,OAAO,OAAO,YAAY,WAAW,UAAU,IAAI,YAAY,SAAS,OAAO;AAChH,UAAI,gBAAgB,OAAO;AACzB,YAAI,UAAU;AACZ,iBAAO,SAAS,gBAAgB,KAAK;AAAA,QACvC;AAAA,MACF;AACA,UAAI,gBAAgB,OAAO,YAAY,OAAO,SAAS,QAAQ,cAAc,UAAU;AAErF,cAAM,UAAU,EAAE,MAAM,SAAS,QAAQ,UAAU,UAAU,SAAS,gBAAgB,KAAK,MAAM,CAAC;AAAA,MACpG;AACA,UAAI,YAAY,CAAC,SAAS,WAAW,SAAS,QAAQ;AACpD,cAAM,UAAU,EAAE,MAAM,SAAS,QAAQ,SAAS,gBAAgB,MAAM,MAAM,CAAC;AAAA,MACjF;AACA,UAAI,UAAU;AACZ,eAAO,SAAS,MAAM,gBAAgB,IAAI;AAAA,MAC5C;AACA,aAAO,gBAAgB;AAAA,IACzB;AAKA,mBAAe,UAAU;AACzB,qBAAS;AAAA;AAAA;","names":[]}